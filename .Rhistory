# Cleaning up gender
RIPA_student <- RIPA.Stop.Data.2018 %>% mutate(STOP_STUDENT = ifelse(STOP_STUDENT == 1, 'Student', 'Non-Student')) %>% mutate(ADS_SEARCH_PERSON = replace_na(ADS_SEARCH_PERSON, 0)) %>% mutate(ADS_SEARCH_PROPERTY = replace_na(ADS_SEARCH_PROPERTY, 0)) %>% mutate(BFS_CONSENT_GIVEN = replace_na(BFS_CONSENT_GIVEN, 0)) %>% mutate(BFS_OFFICER_SAFETY = replace_na(BFS_OFFICER_SAFETY, 0)) %>% mutate(BFS_SEARCH_WARRANT = replace_na(BFS_SEARCH_WARRANT, 0)) %>% mutate(BFS_PAROLE = replace_na(BFS_PAROLE, 0)) %>% mutate(BFS_SUSPECT_WEAPON = replace_na(BFS_SUSPECT_WEAPON, 0)) %>% mutate(BFS_VISIBLE_CONTRABAND = replace_na(BFS_VISIBLE_CONTRABAND, 0)) %>% mutate(BFS_ODOR_CONTRABAND = replace_na(BFS_ODOR_CONTRABAND, 0)) %>% mutate(BFS_CANINE_DETECT = replace_na(BFS_CANINE_DETECT, 0)) %>% mutate(BFS_EVIDENCE = replace_na(BFS_EVIDENCE, 0)) %>% mutate(BFS_INCIDENT = replace_na(BFS_INCIDENT, 0)) %>% mutate(BFS_EXIGENT_CIRCUM = replace_na(BFS_EXIGENT_CIRCUM, 0)) %>% mutate(BFS_VEHICLE_INVENT = replace_na(BFS_VEHICLE_INVENT, 0)) %>% mutate(BFS_SCHOOL_POLICY = replace_na(BFS_SCHOOL_POLICY, 0))
RIPA_student %>% group_by(AGENCY_NAME, STOP_STUDENT) %>% mutate(count = 1) %>% summarize(STOP_COUNT = sum(count))
RIPA_counts_student <- RIPA_student %>% group_by(AGENCY_NAME, STOP_STUDENT) %>% mutate(count = 1) %>% mutate(count_traffic = ifelse(REASON_FOR_STOP == 1, 1, 0)) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(count_search_traffic = ifelse(count_search == 1 & count_traffic == 1, 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_traffic_count = ifelse(contraband_count == 1 & count_traffic == 1, 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(SEARCH_COUNT = replace_na(SEARCH_COUNT, 0)) %>% mutate(SEARCH_CONSENT_COUNT = replace_na(SEARCH_CONSENT_COUNT, 0)) %>% mutate(SEARCH_TRAFFIC_COUNT = replace_na(SEARCH_TRAFFIC_COUNT, 0)) %>% mutate(CONTRABAND_COUNT = replace_na(CONTRABAND_COUNT, 0)) %>% mutate(CONTRABAND_TRAFFIC_COUNT = replace_na(CONTRABAND_TRAFFIC_COUNT, 0)) %>% mutate(USE_FORCE_COUNT = replace_na(USE_FORCE_COUNT, 0))
# RIPA_rates <- RIPA_counts %>% group_by(AGENCY_NAME) %>% mutate(STOP_RATE = ((STOP_COUNT / sum(STOP_COUNT)) * 100))%>% mutate(STOP_RATE_TRAFFIC = ((STOP_COUNT_TRAFFIC / sum(STOP_COUNT_TRAFFIC)) * 100)) %>% mutate(SEARCH_RATE = ((SEARCH_COUNT / sum(SEARCH_COUNT)) * 100)) %>% mutate(SEARCH_CONSENT_RATE = ((SEARCH_CONSENT_COUNT / sum(SEARCH_CONSENT_COUNT)) * 100)) %>% mutate(SEARCH_TRAFFIC_RATE = ((SEARCH_TRAFFIC_COUNT / sum(SEARCH_TRAFFIC_COUNT)) * 100)) %>% mutate(CONTRABAND_RATE = ((CONTRABAND_COUNT / sum(CONTRABAND_COUNT)) * 100)) %>% mutate(CONTRABAND_TRAFFIC_RATE = ((CONTRABAND_TRAFFIC_COUNT / sum(CONTRABAND_TRAFFIC_COUNT)) * 100)) %>% mutate(ARREST_RATE = ((ARREST_COUNT / sum(ARREST_COUNT)) * 100)) %>% mutate(USE_FORCE_RATE = ((USE_FORCE_COUNT / sum(USE_FORCE_COUNT)) * 100))
#
# RIPA_rates_ordered <- RIPA_rates[,c(1, 2, 3, 12, 4, 13, 5, 14, 6, 15, 7, 16, 8, 17, 9, 18, 10, 19, 11, 20)]
RIPA_student %>% group_by(AGENCY_NAME, STOP_STUDENT) %>% mutate(count = 1) %>% summarize(STOP_COUNT = sum(count))
RIPA_counts_student <- RIPA_student %>% group_by(AGENCY_NAME, STOP_STUDENT) %>% mutate(count = 1) %>% mutate(count_traffic = ifelse(REASON_FOR_STOP == 1, 1, 0)) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(count_search_traffic = ifelse(count_search == 1 & count_traffic == 1, 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_traffic_count = ifelse(contraband_count == 1 & count_traffic == 1, 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(SEARCH_COUNT = replace_na(SEARCH_COUNT, 0)) %>% mutate(SEARCH_CONSENT_COUNT = replace_na(SEARCH_CONSENT_COUNT, 0)) %>% mutate(SEARCH_TRAFFIC_COUNT = replace_na(SEARCH_TRAFFIC_COUNT, 0)) %>% mutate(CONTRABAND_COUNT = replace_na(CONTRABAND_COUNT, 0)) %>% mutate(CONTRABAND_TRAFFIC_COUNT = replace_na(CONTRABAND_TRAFFIC_COUNT, 0)) %>% mutate(USE_FORCE_COUNT = replace_na(USE_FORCE_COUNT, 0))
# RIPA_rates <- RIPA_counts %>% group_by(AGENCY_NAME) %>% mutate(STOP_RATE = ((STOP_COUNT / sum(STOP_COUNT)) * 100))%>% mutate(STOP_RATE_TRAFFIC = ((STOP_COUNT_TRAFFIC / sum(STOP_COUNT_TRAFFIC)) * 100)) %>% mutate(SEARCH_RATE = ((SEARCH_COUNT / sum(SEARCH_COUNT)) * 100)) %>% mutate(SEARCH_CONSENT_RATE = ((SEARCH_CONSENT_COUNT / sum(SEARCH_CONSENT_COUNT)) * 100)) %>% mutate(SEARCH_TRAFFIC_RATE = ((SEARCH_TRAFFIC_COUNT / sum(SEARCH_TRAFFIC_COUNT)) * 100)) %>% mutate(CONTRABAND_RATE = ((CONTRABAND_COUNT / sum(CONTRABAND_COUNT)) * 100)) %>% mutate(CONTRABAND_TRAFFIC_RATE = ((CONTRABAND_TRAFFIC_COUNT / sum(CONTRABAND_TRAFFIC_COUNT)) * 100)) %>% mutate(ARREST_RATE = ((ARREST_COUNT / sum(ARREST_COUNT)) * 100)) %>% mutate(USE_FORCE_RATE = ((USE_FORCE_COUNT / sum(USE_FORCE_COUNT)) * 100))
#
# RIPA_rates_ordered <- RIPA_rates[,c(1, 2, 3, 12, 4, 13, 5, 14, 6, 15, 7, 16, 8, 17, 9, 18, 10, 19, 11, 20)]
# Prepare Population data
RIPA_stops_pop_student <- RIPA_counts_student %>% mutate(STOP_RATE_PER_1000 = NaN) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = NaN) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100)
RIPA_rates_ordered_student <- RIPA_stops_pop_student[,c(1, 2, 3, 12, 4, 13, 5, 14, 6, 15, 7, 16, 8, 17, 9, 18, 10, 19, 11, 20)]
RIPA_student_final <- RIPA_rates_ordered_student %>% mutate(IDENTITY_TYPE = 'Student Status') %>% mutate(IDENTITY_SUBTYPE = STOP_STUDENT) %>% select(-c(STOP_STUDENT)) %>% select(1, IDENTITY_TYPE, IDENTITY_SUBTYPE, everything())
write_csv(RIPA_student_final, path="./RIPA_student_final.csv")
#write_csv(RIPA_counts, path="./RIPA_stops_count.csv")
#write_csv(Populationtotals_gather, path="./population_counts")
knitr::opts_chunk$set(echo = TRUE)
# Libraries
library(tidyverse)
options(scipen=999)
# Parameters
head(RIPA.Stop.Data.2018)
# Cleaning up gender
RIPA_lgbtq <- RIPA.Stop.Data.2018 %>% mutate(LGBT = ifelse(LGBT == 1, 'LGBTQ', 'Non-LGBTQ')) %>% mutate(ADS_SEARCH_PERSON = replace_na(ADS_SEARCH_PERSON, 0)) %>% mutate(ADS_SEARCH_PROPERTY = replace_na(ADS_SEARCH_PROPERTY, 0)) %>% mutate(BFS_CONSENT_GIVEN = replace_na(BFS_CONSENT_GIVEN, 0)) %>% mutate(BFS_OFFICER_SAFETY = replace_na(BFS_OFFICER_SAFETY, 0)) %>% mutate(BFS_SEARCH_WARRANT = replace_na(BFS_SEARCH_WARRANT, 0)) %>% mutate(BFS_PAROLE = replace_na(BFS_PAROLE, 0)) %>% mutate(BFS_SUSPECT_WEAPON = replace_na(BFS_SUSPECT_WEAPON, 0)) %>% mutate(BFS_VISIBLE_CONTRABAND = replace_na(BFS_VISIBLE_CONTRABAND, 0)) %>% mutate(BFS_ODOR_CONTRABAND = replace_na(BFS_ODOR_CONTRABAND, 0)) %>% mutate(BFS_CANINE_DETECT = replace_na(BFS_CANINE_DETECT, 0)) %>% mutate(BFS_EVIDENCE = replace_na(BFS_EVIDENCE, 0)) %>% mutate(BFS_INCIDENT = replace_na(BFS_INCIDENT, 0)) %>% mutate(BFS_EXIGENT_CIRCUM = replace_na(BFS_EXIGENT_CIRCUM, 0)) %>% mutate(BFS_VEHICLE_INVENT = replace_na(BFS_VEHICLE_INVENT, 0)) %>% mutate(BFS_SCHOOL_POLICY = replace_na(BFS_SCHOOL_POLICY, 0))
RIPA_lgbtq %>% group_by(AGENCY_NAME, LGBT) %>% mutate(count = 1) %>% summarize(STOP_COUNT = sum(count))
RIPA_counts_lgbtq <- RIPA_lgbtq %>% group_by(AGENCY_NAME, LGBT) %>% mutate(count = 1) %>% mutate(count_traffic = ifelse(REASON_FOR_STOP == 1, 1, 0)) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(count_search_traffic = ifelse(count_search == 1 & count_traffic == 1, 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_traffic_count = ifelse(contraband_count == 1 & count_traffic == 1, 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(SEARCH_COUNT = replace_na(SEARCH_COUNT, 0)) %>% mutate(SEARCH_CONSENT_COUNT = replace_na(SEARCH_CONSENT_COUNT, 0)) %>% mutate(SEARCH_TRAFFIC_COUNT = replace_na(SEARCH_TRAFFIC_COUNT, 0)) %>% mutate(CONTRABAND_COUNT = replace_na(CONTRABAND_COUNT, 0)) %>% mutate(CONTRABAND_TRAFFIC_COUNT = replace_na(CONTRABAND_TRAFFIC_COUNT, 0)) %>% mutate(USE_FORCE_COUNT = replace_na(USE_FORCE_COUNT, 0))
# RIPA_rates <- RIPA_counts %>% group_by(AGENCY_NAME) %>% mutate(STOP_RATE = ((STOP_COUNT / sum(STOP_COUNT)) * 100))%>% mutate(STOP_RATE_TRAFFIC = ((STOP_COUNT_TRAFFIC / sum(STOP_COUNT_TRAFFIC)) * 100)) %>% mutate(SEARCH_RATE = ((SEARCH_COUNT / sum(SEARCH_COUNT)) * 100)) %>% mutate(SEARCH_CONSENT_RATE = ((SEARCH_CONSENT_COUNT / sum(SEARCH_CONSENT_COUNT)) * 100)) %>% mutate(SEARCH_TRAFFIC_RATE = ((SEARCH_TRAFFIC_COUNT / sum(SEARCH_TRAFFIC_COUNT)) * 100)) %>% mutate(CONTRABAND_RATE = ((CONTRABAND_COUNT / sum(CONTRABAND_COUNT)) * 100)) %>% mutate(CONTRABAND_TRAFFIC_RATE = ((CONTRABAND_TRAFFIC_COUNT / sum(CONTRABAND_TRAFFIC_COUNT)) * 100)) %>% mutate(ARREST_RATE = ((ARREST_COUNT / sum(ARREST_COUNT)) * 100)) %>% mutate(USE_FORCE_RATE = ((USE_FORCE_COUNT / sum(USE_FORCE_COUNT)) * 100))
#
# RIPA_rates_ordered <- RIPA_rates[,c(1, 2, 3, 12, 4, 13, 5, 14, 6, 15, 7, 16, 8, 17, 9, 18, 10, 19, 11, 20)]
# Prepare Population data
RIPA_stops_pop_lgbtq <- RIPA_counts_lgbtq %>% mutate(STOP_RATE_PER_1000 = NaN) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = NaN) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100)
RIPA_rates_ordered_lgbtq <- RIPA_stops_pop_lgbtq[,c(1, 2, 3, 12, 4, 13, 5, 14, 6, 15, 7, 16, 8, 17, 9, 18, 10, 19, 11, 20)]
RIPA_lgbtq_final <- RIPA_rates_ordered_lgbtq %>% mutate(IDENTITY_TYPE = 'LGBTQ Status') %>% mutate(IDENTITY_SUBTYPE = LGBT) %>% select(-c(LGBT)) %>% select(1, IDENTITY_TYPE, IDENTITY_SUBTYPE, everything())
write_csv(RIPA_lgbtq_final, path="./RIPA_lgbtq_final.csv")
#write_csv(RIPA_counts, path="./RIPA_stops_count.csv")
#write_csv(Populationtotals_gather, path="./population_counts")
FIXED_CONSENT <- read.csv("~/Google Drive/SENIOR YEAR!/Winter Quarter/CS191/FIXED_CONSENT.csv")
View(FIXED_CONSENT)
final_ripa_all <- arrange(FIXED_CONSENT, AGENCY_NAME, IDENTITY_TYPE, IDENTITY_SUBTYPE)
write_csv(final_ripa_all, path="./final_ripa_all.csv")
View(final_ripa_all)
knitr::opts_chunk$set(echo = TRUE)
# Libraries
library(tidyverse)
options(scipen=999)
RIPA.Stop.Data.2018$AGE <-
ifelse(RIPA.Stop.Data.2018$AGE < 18, "Under 18",
ifelse(RIPA.Stop.Data.2018$AGE <= 29, "18-29", "30+"))
RIPA_arrest_codes <- RIPA.Stop.Data.2018[!(RIPA_r$ROS_CUSTODIAL_WOUT_WARRANT_CDS == " ") , ] %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = strsplit(as.character(ROS_CUSTODIAL_WOUT_WARRANT_CDS), ", ")) %>% unnest(ROS_CUSTODIAL_WOUT_WARRANT_CDS) %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = as.numeric(ROS_CUSTODIAL_WOUT_WARRANT_CDS))
RIPA_arrest_join_code <- RIPA_arrest_codes %>% inner_join(CDS_Codes, by = c("ROS_CUSTODIAL_WOUT_WARRANT_CDS" = "CDS.Code"))
CDS_Codes <- read.csv("~/Google Drive/SENIOR YEAR!/Winter Quarter/CS191/CDS_Codes.csv")
View(CDS_Codes)
RIPA_arrest_join_code <- RIPA_arrest_codes %>% inner_join(CDS_Codes, by = c("ROS_CUSTODIAL_WOUT_WARRANT_CDS" = "CDS.Code"))
RIPA_arrest_offense_counts_age <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), UNDER_18_PERCENT = (sum(AGE == "Under 18") / TOTAL) * 100, EIGHTEEN_TWENTYNINE_PERCENT = (sum(AGE == "18-29") / TOTAL) * 100, THIRTY_PLUS_PERCENT = (sum(AGE == "30+") / TOTAL) * 100) %>% filter(TOTAL >= 50) %>% ungroup()
RIPA_top_arrests_age <- RIPA_arrest_offense_counts %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
RIPA_top_arrests_age <- RIPA_arrest_offense_counts_age %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
View(RIPA_stops_pop)
View(RIPA_top_arrests_age)
RIPA_arrest_offense_counts_age <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), UNDER_18_COUNT = sum(AGE == "Under 18"), EIGHTEEN_TWENTYNINE_COUNT = sum(AGE == "18-29"), THIRTY_PLUS_COUNT = sum(AGE == "30+")) %>% filter(TOTAL >= 50) %>% ungroup()
RIPA_top_arrests_age <- RIPA_arrest_offense_counts_age %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
RIPA_arrest_offense_counts_age <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), UNDER_18_COUNT = sum(AGE == "Under 18"), EIGHTEEN_TWENTYNINE_COUNT = sum(AGE == "18-29"), THIRTY_PLUS_COUNT = sum(AGE == "30+")) %>% filter(UNDER_18_COUNT >= 100) %>% ungroup()
RIPA_top_arrests_age <- RIPA_arrest_offense_counts_age %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
RIPA_arrest_offense_counts_age <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), UNDER_18_COUNT = sum(AGE == "Under 18"), EIGHTEEN_TWENTYNINE_COUNT = sum(AGE == "18-29"), THIRTY_PLUS_COUNT = sum(AGE == "30+")) %>% filter(UNDER_18_COUNT >= 50) %>% ungroup()
RIPA_top_arrests_age <- RIPA_arrest_offense_counts_age %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
RIPA_arrest_offense_counts_age <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), UNDER_18_COUNT = sum(AGE == "Under 18"), EIGHTEEN_TWENTYNINE_COUNT = sum(AGE == "18-29"), THIRTY_PLUS_COUNT = sum(AGE == "30+"))
RIPA_top_arrests_age <- RIPA_arrest_offense_counts_age %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
View(RIPA_stops_pop_disability)
RIPA_arrest_offense_counts_age <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), UNDER_18_COUNT = sum(AGE == "Under 18"), EIGHTEEN_TWENTYNINE_COUNT = sum(AGE == "18-29"), THIRTY_PLUS_COUNT = sum(AGE == "30+")) %>% filter(UNDER_18_COUNT >= 10) %>% ungroup()
RIPA_top_arrests_age <- RIPA_arrest_offense_counts_age %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
RIPA_top_arrests_age <- RIPA_arrest_offense_counts_age %>% arrange(AGENCY_NAME, Offense.Level, desc(UNDER_18_COUNT))
RIPA_arrest_offense_counts_age <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), UNDER_18_COUNT = sum(AGE == "Under 18"), EIGHTEEN_TWENTYNINE_COUNT = sum(AGE == "18-29"), THIRTY_PLUS_COUNT = sum(AGE == "30+"))
RIPA_top_arrests_age <- RIPA_arrest_offense_counts_age %>% arrange(AGENCY_NAME, Offense.Level, desc(UNDER_18_COUNT))
write_csv(RIPA_top_arrests, path="./RIPA_top_arrests_age.csv")
write_csv(RIPA_top_arrests_age, path="./RIPA_top_arrests_age.csv")
knitr::opts_chunk$set(echo = TRUE)
# Libraries
library(tidyverse)
options(scipen=999)
head(RIPA.Stop.Data.2018)
RIPA.Stop.Data.2018$RACE <-
ifelse(RIPA.Stop.Data.2018$RAE_FULL == 1, "Asian",
ifelse(RIPA.Stop.Data.2018$RAE_FULL == 2, "Black",
ifelse(RIPA.Stop.Data.2018$RAE_FULL == 3, "Hispanic",
ifelse(RIPA.Stop.Data.2018$RAE_FULL == 4, "Asian",
ifelse(RIPA.Stop.Data.2018$RAE_FULL == 8, "Multiracial",
ifelse(RIPA.Stop.Data.2018$RAE_FULL == 5, "Native American",
ifelse(RIPA.Stop.Data.2018$RAE_FULL == 6, "Pacific Islander", "White")))))))
RIPA_r <- RIPA.Stop.Data.2018 %>% select(-starts_with('RAE_')) %>% select(1:13, RACE, everything())
RIPA_r <- RIPA.Stop.Data.2018 %>% select(-starts_with('RAE_')) %>% select(1:13, RACE, everything())
RIPA_arrest_codes <- RIPA_r[!(RIPA_r$ROS_CUSTODIAL_WOUT_WARRANT_CDS == " ") , ] %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = strsplit(as.character(ROS_CUSTODIAL_WOUT_WARRANT_CDS), ", ")) %>% unnest(ROS_CUSTODIAL_WOUT_WARRANT_CDS) %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = as.numeric(ROS_CUSTODIAL_WOUT_WARRANT_CDS))
RIPA_arrest_join_code <- RIPA_arrest_codes %>% inner_join(CDS_Codes, by = c("ROS_CUSTODIAL_WOUT_WARRANT_CDS" = "CDS.Code"))
RIPA_arrest_offense_counts <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), WHITE_ARRESTS_COUNT = sum(RACE == "White"), BLACK_ARRESTS_COUNT = sum(RACE == "Black"), HISPANIC_ARRESTS_COUNT = sum(RACE == "Hispanic"), ASIAN_ARRESTS_COUNT = sum(RACE == "Asian"), MULTIRACIAL_ARRESTS_COUNT = sum(RACE == "Multiracial"), NATIVEAM_ARRESTS_COUNT = sum(RACE == "Native American"), PACISL_ARRESTS_COUNT = sum(RACE == "Pacific Islander")) %>% filter(TOTAL >= 50) %>% ungroup()
RIPA_arrest_join_code <- RIPA_arrest_codes %>% inner_join(CDS_Codes, by = c("ROS_CUSTODIAL_WOUT_WARRANT_CDS" = "CDS.Code"))
RIPA_arrest_offense_counts <- RIPA_arrest_join_code %>% group_by(AGENCY_NAME, Offense.Description, Offense.Level) %>% summarise(TOTAL = n(), WHITE_ARRESTS_COUNT = sum(RACE == "White"), BLACK_ARRESTS_COUNT = sum(RACE == "Black"), HISPANIC_ARRESTS_COUNT = sum(RACE == "Hispanic"), ASIAN_ARRESTS_COUNT = sum(RACE == "Asian"), MULTIRACIAL_ARRESTS_COUNT = sum(RACE == "Multiracial"), NATIVEAM_ARRESTS_COUNT = sum(RACE == "Native American"), PACISL_ARRESTS_COUNT = sum(RACE == "Pacific Islander")) %>% filter(TOTAL >= 50) %>% ungroup()
RIPA_top_arrests <- RIPA_arrest_offense_counts %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
View(RIPA_arrest_offense_counts)
library(readxl)
Populationtotals <- read_excel("Google Drive/SENIOR YEAR!/Winter Quarter/CS191/cpz_ripa/Populationtotals.xlsx")
View(Populationtotals)
RIPA_arrest_offense_counts %>% inner_join(by = c("AGENCY_NAME" = "Agency"))
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency"))
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(BLACK_ARREST_PROP_POP = BLACK_ARRESTS_COUNT / Black )
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(BLACK_ARREST_PROP_POP = (BLACK_ARRESTS_COUNT / Black) * 1000 )
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(BLACK_ARREST_PROP_POP = (BLACK_ARRESTS_COUNT / Black) * 100000 )
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARREST_PROP_POP = (WHITE_ARREST_COUNT / White) * 100000, BLACK_ARREST_PROP_POP = (BLACK_ARRESTS_COUNT / Black) * 100000 )
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARREST_PROP_POP = (WHITE_ARRESTS_COUNT / White) * 100000, BLACK_ARREST_PROP_POP = (BLACK_ARRESTS_COUNT / Black) * 100000 )
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(BLACK_ARREST_PROP_POP = (BLACK_ARRESTS_COUNT / TOTAL)  )
library(readxl)
Populationtotals <- read_excel("Google Drive/SENIOR YEAR!/Winter Quarter/CS191/cpz_ripa/Populationtotals.xlsx")
View(Populationtotals)
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100)
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF = ((BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP) / BLACK_ARRESTS_PROP) * 100)
RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF_POP = BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP)
RIPA_arrests_diff <- RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF_POP = BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP, HISPANIC_ARRESTS_PROP = (HISPANIC_ARRESTS_COUNT / TOTAL) * 100, HISPANIC_ARRESTS_PROP_POP = (Hispanic / Total) * 100, HISPANIC_ARREST_DIFF_POP = HISPANIC_ARRESTS_PROP - HISPANIC_ARRESTS_PROP_POP)
View(RIPA_arrests_diff)
RIPA_arrests_diff <- RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARRESTS_PROP = (WHITE_ARRESTS_COUNT / TOTAL) * 100, WHITE_ARRESTS_PROP_POP = (White / Total) * 100, WHITE_ARREST_DIFF_POP = WHITE_ARRESTS_PROP - WHITE_ARRESTS_PROP_POP, BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF_POP = BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP, HISPANIC_ARRESTS_PROP = (HISPANIC_ARRESTS_COUNT / TOTAL) * 100, HISPANIC_ARRESTS_PROP_POP = (Hispanic / Total) * 100, HISPANIC_ARREST_DIFF_POP = HISPANIC_ARRESTS_PROP - HISPANIC_ARRESTS_PROP_POP)
RIPA_arrests_diff <- RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARRESTS_PROP = (WHITE_ARRESTS_COUNT / TOTAL) * 100, WHITE_ARRESTS_PROP_POP = (White / Total) * 100, WHITE_ARREST_DIFF_POP = WHITE_ARRESTS_PROP - WHITE_ARRESTS_PROP_POP, BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF_POP = BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP, HISPANIC_ARRESTS_PROP = (HISPANIC_ARRESTS_COUNT / TOTAL) * 100, HISPANIC_ARRESTS_PROP_POP = (Hispanic / Total) * 100, HISPANIC_ARREST_DIFF_POP = HISPANIC_ARRESTS_PROP - HISPANIC_ARRESTS_PROP_POP,  ASIAN_ARRESTS_PROP = (ASIAN_ARRESTS_COUNT / TOTAL) * 100, ASIAN_ARRESTS_PROP_POP = (Asian / Total) * 100, ASIAN_ARREST_DIFF_POP = ASIAN_ARRESTS_PROP - ASIAN_ARRESTS_PROP_POP, MULTIRACIAL_ARRESTS_PROP = (MULTIRACIAL_ARRESTS_COUNT / TOTAL) * 100, MULTIRACIAL_ARRESTS_PROP_POP = (Multiracial / Total) * 100, MULTIRACIAL_ARREST_DIFF_POP = MULTIRACIAL_ARRESTS_PROP - MULTIRACIAL_ARRESTS_PROP_POP, NATIVE_ARRESTS_PROP = (NATIVE_ARRESTS_COUNT / TOTAL) * 100, NATIVE_ARRESTS_PROP_POP = ('Native American' / Total) * 100, NATIVE_ARREST_DIFF_POP = NATIVE_ARRESTS_PROP - NATIVE_ARRESTS_PROP_POP)
RIPA_arrests_diff <- RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARRESTS_PROP = (WHITE_ARRESTS_COUNT / TOTAL) * 100, WHITE_ARRESTS_PROP_POP = (White / Total) * 100, WHITE_ARREST_DIFF_POP = WHITE_ARRESTS_PROP - WHITE_ARRESTS_PROP_POP, BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF_POP = BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP, HISPANIC_ARRESTS_PROP = (HISPANIC_ARRESTS_COUNT / TOTAL) * 100, HISPANIC_ARRESTS_PROP_POP = (Hispanic / Total) * 100, HISPANIC_ARREST_DIFF_POP = HISPANIC_ARRESTS_PROP - HISPANIC_ARRESTS_PROP_POP,  ASIAN_ARRESTS_PROP = (ASIAN_ARRESTS_COUNT / TOTAL) * 100, ASIAN_ARRESTS_PROP_POP = (Asian / Total) * 100, ASIAN_ARREST_DIFF_POP = ASIAN_ARRESTS_PROP - ASIAN_ARRESTS_PROP_POP, MULTIRACIAL_ARRESTS_PROP = (MULTIRACIAL_ARRESTS_COUNT / TOTAL) * 100, MULTIRACIAL_ARRESTS_PROP_POP = (Multiracial / Total) * 100, MULTIRACIAL_ARREST_DIFF_POP = MULTIRACIAL_ARRESTS_PROP - MULTIRACIAL_ARRESTS_PROP_POP, NATIVE_ARRESTS_PROP = (NATIVEAM_ARRESTS_COUNT / TOTAL) * 100, NATIVE_ARRESTS_PROP_POP = ('Native American' / Total) * 100, NATIVE_ARREST_DIFF_POP = NATIVE_ARRESTS_PROP - NATIVE_ARRESTS_PROP_POP)
RIPA_arrests_diff <- RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARRESTS_PROP = (WHITE_ARRESTS_COUNT / TOTAL) * 100, WHITE_ARRESTS_PROP_POP = (White / Total) * 100, WHITE_ARREST_DIFF_POP = WHITE_ARRESTS_PROP - WHITE_ARRESTS_PROP_POP, BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF_POP = BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP, HISPANIC_ARRESTS_PROP = (HISPANIC_ARRESTS_COUNT / TOTAL) * 100, HISPANIC_ARRESTS_PROP_POP = (Hispanic / Total) * 100, HISPANIC_ARREST_DIFF_POP = HISPANIC_ARRESTS_PROP - HISPANIC_ARRESTS_PROP_POP,  ASIAN_ARRESTS_PROP = (ASIAN_ARRESTS_COUNT / TOTAL) * 100, ASIAN_ARRESTS_PROP_POP = (Asian / Total) * 100, ASIAN_ARREST_DIFF_POP = ASIAN_ARRESTS_PROP - ASIAN_ARRESTS_PROP_POP, MULTIRACIAL_ARRESTS_PROP = (MULTIRACIAL_ARRESTS_COUNT / TOTAL) * 100, MULTIRACIAL_ARRESTS_PROP_POP = (Multiracial / Total) * 100, MULTIRACIAL_ARREST_DIFF_POP = MULTIRACIAL_ARRESTS_PROP - MULTIRACIAL_ARRESTS_PROP_POP, NATIVE_ARRESTS_PROP = (NATIVEAM_ARRESTS_COUNT / TOTAL) * 100, NATIVE_ARRESTS_PROP_POP = (`Native American` / Total) * 100, NATIVE_ARREST_DIFF_POP = NATIVE_ARRESTS_PROP - NATIVE_ARRESTS_PROP_POP)
RIPA_arrests_diff <- RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARRESTS_PROP = (WHITE_ARRESTS_COUNT / TOTAL) * 100, WHITE_ARRESTS_PROP_POP = (White / Total) * 100, WHITE_ARREST_DIFF_POP = WHITE_ARRESTS_PROP - WHITE_ARRESTS_PROP_POP, BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF_POP = BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP, HISPANIC_ARRESTS_PROP = (HISPANIC_ARRESTS_COUNT / TOTAL) * 100, HISPANIC_ARRESTS_PROP_POP = (Hispanic / Total) * 100, HISPANIC_ARREST_DIFF_POP = HISPANIC_ARRESTS_PROP - HISPANIC_ARRESTS_PROP_POP,  ASIAN_ARRESTS_PROP = (ASIAN_ARRESTS_COUNT / TOTAL) * 100, ASIAN_ARRESTS_PROP_POP = (Asian / Total) * 100, ASIAN_ARREST_DIFF_POP = ASIAN_ARRESTS_PROP - ASIAN_ARRESTS_PROP_POP, MULTIRACIAL_ARRESTS_PROP = (MULTIRACIAL_ARRESTS_COUNT / TOTAL) * 100, MULTIRACIAL_ARRESTS_PROP_POP = (Multiracial / Total) * 100, MULTIRACIAL_ARREST_DIFF_POP = MULTIRACIAL_ARRESTS_PROP - MULTIRACIAL_ARRESTS_PROP_POP, NATIVE_ARRESTS_PROP = (NATIVEAM_ARRESTS_COUNT / TOTAL) * 100, NATIVE_ARRESTS_PROP_POP = (`Native American` / Total) * 100, NATIVE_ARREST_DIFF_POP = NATIVE_ARRESTS_PROP - NATIVE_ARRESTS_PROP_POP, PACISL_ARRESTS_PROP = (PACISL_ARRESTS_COUNT / TOTAL) * 100, PACISL_ARRESTS_PROP_POP = (`Pacific Islander` / Total) * 100, PACISL_ARREST_DIFF_POP = PACISL_ARRESTS_PROP - PACISL_ARRESTS_PROP_POP )
write_csv(RIPA_arrests_diff, path="./RIPA_arrests_diff.csv")
RIPA_arrests_diff <- RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARRESTS_PROP = (WHITE_ARRESTS_COUNT / TOTAL) * 100, WHITE_ARRESTS_PROP_POP = (White / Total) * 100, WHITE_ARREST_DIFF_POP = WHITE_ARRESTS_PROP - WHITE_ARRESTS_PROP_POP, BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_DIFF_POP = BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP, HISPANIC_ARRESTS_PROP = (HISPANIC_ARRESTS_COUNT / TOTAL) * 100, HISPANIC_ARRESTS_PROP_POP = (Hispanic / Total) * 100, HISPANIC_ARREST_DIFF_POP = HISPANIC_ARRESTS_PROP - HISPANIC_ARRESTS_PROP_POP,  ASIAN_ARRESTS_PROP = (ASIAN_ARRESTS_COUNT / TOTAL) * 100, ASIAN_ARRESTS_PROP_POP = (Asian / Total) * 100, ASIAN_ARREST_DIFF_POP = ASIAN_ARRESTS_PROP - ASIAN_ARRESTS_PROP_POP, MULTIRACIAL_ARRESTS_PROP = (MULTIRACIAL_ARRESTS_COUNT / TOTAL) * 100, MULTIRACIAL_ARRESTS_PROP_POP = (Multiracial / Total) * 100, MULTIRACIAL_ARREST_DIFF_POP = MULTIRACIAL_ARRESTS_PROP - MULTIRACIAL_ARRESTS_PROP_POP, NATIVE_ARRESTS_PROP = (NATIVEAM_ARRESTS_COUNT / TOTAL) * 100, NATIVE_ARRESTS_PROP_POP = (`Native American` / Total) * 100, NATIVE_ARREST_DIFF_POP = NATIVE_ARRESTS_PROP - NATIVE_ARRESTS_PROP_POP, PACISL_ARRESTS_PROP = (PACISL_ARRESTS_COUNT / TOTAL) * 100, PACISL_ARRESTS_PROP_POP = (`Pacific Islander` / Total) * 100, PACISL_ARREST_DIFF_POP = PACISL_ARRESTS_PROP - PACISL_ARRESTS_PROP_POP ) %>% filter(Offense.Level != "F")
RIPA_top_arrests <- RIPA_arrests_diff %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
View(RIPA_top_arrests)
write_csv(RIPA_top_arrests, path="./RIPA_arrests_diff.csv")
View(RIPA_top_arrests)
knitr::opts_chunk$set(echo = TRUE)
# Libraries
library(tidyverse)
options(scipen=999)
RIPA_arrests_diff <- RIPA_arrest_offense_counts %>% inner_join(Populationtotals, by = c("AGENCY_NAME" = "Agency")) %>% mutate(WHITE_ARRESTS_PROP = (WHITE_ARRESTS_COUNT / TOTAL) * 100, WHITE_ARRESTS_PROP_POP = (White / Total) * 100, WHITE_ARREST_PERCENT_DIFF = ((WHITE_ARRESTS_PROP - WHITE_ARRESTS_PROP_POP) /  WHITE_ARRESTS_PROP_POP) * 100, BLACK_ARRESTS_PROP = (BLACK_ARRESTS_COUNT / TOTAL) * 100, BLACK_ARRESTS_PROP_POP = (Black / Total) * 100, BLACK_ARREST_PERCENT_DIFF = ((BLACK_ARRESTS_PROP - BLACK_ARRESTS_PROP_POP) /  BLACK_ARRESTS_PROP_POP) * 100, HISPANIC_ARRESTS_PROP = (HISPANIC_ARRESTS_COUNT / TOTAL) * 100, HISPANIC_ARRESTS_PROP_POP = (Hispanic / Total) * 100, HISPANIC_ARREST_PERCENT_DIFF = ((HISPANIC_ARRESTS_PROP - HISPANIC_ARRESTS_PROP_POP) /  HISPANIC_ARRESTS_PROP_POP) * 100,  ASIAN_ARRESTS_PROP = (ASIAN_ARRESTS_COUNT / TOTAL) * 100, ASIAN_ARRESTS_PROP_POP = (Asian / Total) * 100, ASIAN_ARREST_PERCENT_DIFF = ((ASIAN_ARRESTS_PROP - ASIAN_ARRESTS_PROP_POP) /  ASIAN_ARRESTS_PROP_POP) * 100, MULTIRACIAL_ARRESTS_PROP = (MULTIRACIAL_ARRESTS_COUNT / TOTAL) * 100, MULTIRACIAL_ARRESTS_PROP_POP = (Multiracial / Total) * 100, MULTIRACIAL_ARREST_PERCENT_DIFF = ((MULTIRACIAL_ARRESTS_PROP - MULTIRACIAL_ARRESTS_PROP_POP) /  MULTIRACIAL_ARRESTS_PROP_POP) * 100, NATIVE_ARRESTS_PROP = (NATIVEAM_ARRESTS_COUNT / TOTAL) * 100, NATIVE_ARRESTS_PROP_POP = (`Native American` / Total) * 100, NATIVE_ARREST_PERCENT_DIFF = ((NATIVE_ARRESTS_PROP - NATIVE_ARRESTS_PROP_POP) /  NATIVE_ARRESTS_PROP_POP) * 100, PACISL_ARRESTS_PROP = (PACISL_ARRESTS_COUNT / TOTAL) * 100, PACISL_ARRESTS_PROP_POP = (`Pacific Islander` / Total) * 100, PACISL_ARREST_PERCENT_DIFF = ((PACISL_ARRESTS_PROP - PACISL_ARRESTS_PROP_POP) /  PACISL_ARRESTS_PROP_POP) * 100) %>% filter(Offense.Level != "F")
RIPA_top_arrests <- RIPA_arrests_diff %>% arrange(AGENCY_NAME, Offense.Level, desc(TOTAL))
View(RIPA_top_arrests)
write_csv(RIPA_top_arrests, path="./RIPA_arrests_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
# Libraries
library(tidyverse)
options(scipen=999)
head(RIPA.Stop.Data.2018)
RIPA_annotated <- RIPA.Stop.Data.2018 %>% select (-c(G_FEMALE, G_GENDER_NONCONFORMING, G_MALE, G_TRANSGENDER_MAN, G_TRANSGENDER_WOMAN, G_FULL, G_MULTIGENDER)) %>% select(1:14, GENDER, everything()) %>% mutate(ADS_SEARCH_PERSON = replace_na(ADS_SEARCH_PERSON, 0)) %>% mutate(ADS_SEARCH_PROPERTY = replace_na(ADS_SEARCH_PROPERTY, 0)) %>% mutate(BFS_CONSENT_GIVEN = replace_na(BFS_CONSENT_GIVEN, 0)) %>% mutate(BFS_OFFICER_SAFETY = replace_na(BFS_OFFICER_SAFETY, 0)) %>% mutate(BFS_SEARCH_WARRANT = replace_na(BFS_SEARCH_WARRANT, 0)) %>% mutate(BFS_PAROLE = replace_na(BFS_PAROLE, 0)) %>% mutate(BFS_SUSPECT_WEAPON = replace_na(BFS_SUSPECT_WEAPON, 0)) %>% mutate(BFS_VISIBLE_CONTRABAND = replace_na(BFS_VISIBLE_CONTRABAND, 0)) %>% mutate(BFS_ODOR_CONTRABAND = replace_na(BFS_ODOR_CONTRABAND, 0)) %>% mutate(BFS_CANINE_DETECT = replace_na(BFS_CANINE_DETECT, 0)) %>% mutate(BFS_EVIDENCE = replace_na(BFS_EVIDENCE, 0)) %>% mutate(BFS_INCIDENT = replace_na(BFS_INCIDENT, 0)) %>% mutate(BFS_EXIGENT_CIRCUM = replace_na(BFS_EXIGENT_CIRCUM, 0)) %>% mutate(BFS_VEHICLE_INVENT = replace_na(BFS_VEHICLE_INVENT, 0)) %>% mutate(BFS_SCHOOL_POLICY = replace_na(BFS_SCHOOL_POLICY, 0))
head(RIPA_annotated)
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_traffic = ifelse(REASON_FOR_STOP == 1, 1, 0)) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(count_search_traffic = ifelse(count_search == 1 & count_traffic == 1, 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_traffic_count = ifelse(contraband_count == 1 & count_traffic == 1, 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(SEARCH_COUNT = replace_na(SEARCH_COUNT, 0)) %>% mutate(SEARCH_CONSENT_COUNT = replace_na(SEARCH_CONSENT_COUNT, 0)) %>% mutate(SEARCH_TRAFFIC_COUNT = replace_na(SEARCH_TRAFFIC_COUNT, 0)) %>% mutate(CONTRABAND_COUNT = replace_na(CONTRABAND_COUNT, 0)) %>% mutate(CONTRABAND_TRAFFIC_COUNT = replace_na(CONTRABAND_TRAFFIC_COUNT, 0)) %>% mutate(USE_FORCE_COUNT = replace_na(USE_FORCE_COUNT, 0))
View(RIPA_counts)
View(Populationtotals)
left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "AGENCY_NAME")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / POPULATION) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / POPULATION) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100)
left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / POPULATION) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / POPULATION) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100)
left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100)
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100)
View(RIPA_stops_pop)
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100) %>% select(-c(Hispanic, White, Black, `Native American`, Asian, `Pacific Islander`, Multiracial))
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100) %>% select(-c(Hispanic, White, Black, `Native American`, Asian, `Pacific Islander`, Multiracial, STOP_COUNT, `%_COUNT`))
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100) %>% select(-c(Hispanic, White, Black, `Native American`, Asian, `Pacific Islander`, Multiracial, STOP_COUNT, contains("COUNT")))
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100) %>% select(-c(Hispanic, White, Black, `Native American`, Asian, `Pacific Islander`, Multiracial, Total, STOP_COUNT, contains("COUNT")))
write_csv(RIPA_stops_pop, path="./RIPA_general_stops.csv")
View(RIPA.Stop.Data.2018)
RIPA_counts %>% count(CED_NONE_CONTRABAND, CED_FIREARM)
RIPA_annotated %>% count(CED_NONE_CONTRABAND, CED_FIREARM)
RIPA_annotated %>% count(CED_NONE_CONTRABAND, CED_AMMUNITION)
RIPA_annotated %>% count(CED_NONE_CONTRABAND, CED_WEAPON)
RIPA_annotated %>% count(CED_NONE_CONTRABAND, CED_AMMUNITION)
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_traffic = ifelse(REASON_FOR_STOP == 1, 1, 0)) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(count_search_traffic = ifelse(count_search == 1 & count_traffic == 1, 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = contraband_count == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(contraband_traffic_count = ifelse(contraband_count == 1 & count_traffic == 1, 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(SEARCH_COUNT = replace_na(SEARCH_COUNT, 0)) %>% mutate(SEARCH_CONSENT_COUNT = replace_na(SEARCH_CONSENT_COUNT, 0)) %>% mutate(SEARCH_TRAFFIC_COUNT = replace_na(SEARCH_TRAFFIC_COUNT, 0)) %>% mutate(CONTRABAND_COUNT = replace_na(CONTRABAND_COUNT, 0)) %>% mutate(CONTRABAND_TRAFFIC_COUNT = replace_na(CONTRABAND_TRAFFIC_COUNT, 0)) %>% mutate(USE_FORCE_COUNT = replace_na(USE_FORCE_COUNT, 0))
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>% mutate(CONTRABAND_NO_WEAPON_PERCENT = (contraband_no_weapon_count / contraband_count) * 100) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100) %>% select(-c(Hispanic, White, Black, `Native American`, Asian, `Pacific Islander`, Multiracial, Total, STOP_COUNT, contains("COUNT")))
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_traffic = ifelse(REASON_FOR_STOP == 1, 1, 0)) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(count_search_traffic = ifelse(count_search == 1 & count_traffic == 1, 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = contraband_count == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(contraband_traffic_count = ifelse(contraband_count == 1 & count_traffic == 1, 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(SEARCH_COUNT = replace_na(SEARCH_COUNT, 0)) %>% mutate(SEARCH_CONSENT_COUNT = replace_na(SEARCH_CONSENT_COUNT, 0)) %>% mutate(SEARCH_TRAFFIC_COUNT = replace_na(SEARCH_TRAFFIC_COUNT, 0)) %>% mutate(CONTRABAND_COUNT = replace_na(CONTRABAND_COUNT, 0)) %>% mutate(CONTRABAND_TRAFFIC_COUNT = replace_na(CONTRABAND_TRAFFIC_COUNT, 0)) %>% mutate(USE_FORCE_COUNT = replace_na(USE_FORCE_COUNT, 0))
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>% mutate(CONTRABAND_NO_WEAPON_PERCENT = (contraband_no_weapon_count / contraband_count) * 100) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100) %>% select(-c(Hispanic, White, Black, `Native American`, Asian, `Pacific Islander`, Multiracial, Total, STOP_COUNT, contains("COUNT")))
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_traffic = ifelse(REASON_FOR_STOP == 1, 1, 0)) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(count_search_traffic = ifelse(count_search == 1 & count_traffic == 1, 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = contraband_count == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(contraband_traffic_count = ifelse(contraband_count == 1 & count_traffic == 1, 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
CONTRABAND_NO_WEAPON_COUNT = sum(contraband_no_weapon_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(SEARCH_COUNT = replace_na(SEARCH_COUNT, 0)) %>% mutate(SEARCH_CONSENT_COUNT = replace_na(SEARCH_CONSENT_COUNT, 0)) %>% mutate(SEARCH_TRAFFIC_COUNT = replace_na(SEARCH_TRAFFIC_COUNT, 0)) %>% mutate(CONTRABAND_COUNT = replace_na(CONTRABAND_COUNT, 0)) %>% mutate(CONTRABAND_TRAFFIC_COUNT = replace_na(CONTRABAND_TRAFFIC_COUNT, 0)) %>% mutate(USE_FORCE_COUNT = replace_na(USE_FORCE_COUNT, 0))
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>% mutate(CONTRABAND_NO_WEAPON_PERCENT = (CONTRABAND_NO_WEAPON_COUNT / CONTRABAND_COUNT) * 100) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100) %>% select(-c(Hispanic, White, Black, `Native American`, Asian, `Pacific Islander`, Multiracial, Total, STOP_COUNT, contains("COUNT")))
write_csv(RIPA_stops_pop, path="./RIPA_general_stops.csv")
knitr::opts_chunk$set(echo = TRUE)
RIPA_annotated <- RIPA.Stop.Data.2018 %>% select (-c(G_FEMALE, G_GENDER_NONCONFORMING, G_MALE, G_TRANSGENDER_MAN, G_TRANSGENDER_WOMAN, G_FULL, G_MULTIGENDER)) %>% select(1:14, GENDER, everything()) %>% mutate(ADS_SEARCH_PERSON = replace_na(ADS_SEARCH_PERSON, 0)) %>% mutate(ADS_SEARCH_PROPERTY = replace_na(ADS_SEARCH_PROPERTY, 0)) %>% mutate(BFS_CONSENT_GIVEN = replace_na(BFS_CONSENT_GIVEN, 0)) %>% mutate(BFS_OFFICER_SAFETY = replace_na(BFS_OFFICER_SAFETY, 0)) %>% mutate(BFS_SEARCH_WARRANT = replace_na(BFS_SEARCH_WARRANT, 0)) %>% mutate(BFS_PAROLE = replace_na(BFS_PAROLE, 0)) %>% mutate(BFS_SUSPECT_WEAPON = replace_na(BFS_SUSPECT_WEAPON, 0)) %>% mutate(BFS_VISIBLE_CONTRABAND = replace_na(BFS_VISIBLE_CONTRABAND, 0)) %>% mutate(BFS_ODOR_CONTRABAND = replace_na(BFS_ODOR_CONTRABAND, 0)) %>% mutate(BFS_CANINE_DETECT = replace_na(BFS_CANINE_DETECT, 0)) %>% mutate(BFS_EVIDENCE = replace_na(BFS_EVIDENCE, 0)) %>% mutate(BFS_INCIDENT = replace_na(BFS_INCIDENT, 0)) %>% mutate(BFS_EXIGENT_CIRCUM = replace_na(BFS_EXIGENT_CIRCUM, 0)) %>% mutate(BFS_VEHICLE_INVENT = replace_na(BFS_VEHICLE_INVENT, 0)) %>% mutate(BFS_SCHOOL_POLICY = replace_na(BFS_SCHOOL_POLICY, 0))
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
CONTRABAND_NO_WEAPON_COUNT = sum(contraband_no_weapon_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1)
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1)
View(RIPA_force)
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% summarize(  USE_FORCE_COUNT = sum(use_of_force_count)
,   USE_FORCE__FIREARM_DISCHARGE_COUNT = sum(use_of_force_firearm_discharge_count)
)
View(RIPA_force)
View(RIPA_g)
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), USE_FORCE_FIREARM_DISCHARGE_COUNT = sum(use_of_force_firearm_discharge_count), USE_FORCE_FIREARM_POINT_COUNT = sum(use_of_force_firearm_point_count), USE_FORCE_BATON_COUNT = sum(use_of_force_baton_count), USE_FORCE_CHEM_SPRAY_COUNT = sum(use_of_force_chem_spray_count), USE_FORCE_IMPACT_DISCHARGE_COUNT = sum(use_of_force_IMPACT_discharge_count), USE_FORCE_CANINE_BITE_COUNT = sum(use_of_force_canine_bite_count), USE_FORCE_ELECT_DEVICE_COUNT = sum(use_of_force_elect_device_count))
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), USE_FORCE_FIREARM_DISCHARGE_COUNT = sum(use_of_force_firearm_discharge_count), USE_FORCE_FIREARM_POINT_COUNT = sum(use_of_force_firearm_point_count), USE_FORCE_BATON_COUNT = sum(use_of_force_baton_count), USE_FORCE_CHEM_SPRAY_COUNT = sum(use_of_force_chem_spray_count), USE_FORCE_IMPACT_DISCHARGE_COUNT = sum(use_of_force_impact_discharge_count), USE_FORCE_CANINE_BITE_COUNT = sum(use_of_force_canine_bite_count), USE_FORCE_ELECT_DEVICE_COUNT = sum(use_of_force_elect_device_count))
View(RIPA_force)
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), USE_FORCE_FIREARM_DISCHARGE_RATE = (sum(use_of_force_firearm_discharge_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_FIREARM_POINT_COUNT = (sum(use_of_force_firearm_point_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_BATON_COUNT = (sum(use_of_force_baton_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CHEM_SPRAY_COUNT = (sum(use_of_force_chem_spray_count) / USE_FORCE_COUNT) * 100, USE_FORCE_IMPACT_DISCHARGE_COUNT = (sum(use_of_force_impact_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CANINE_BITE_COUNT = (sum(use_of_force_canine_bite_count) / USE_FORCE_COUNT) * 100, USE_FORCE_ELECT_DEVICE_COUNT = (sum(use_of_force_elect_device_count) / USE_FORCE_COUNT) * 100)
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), USE_FORCE_FIREARM_DISCHARGE_RATE = (sum(use_of_force_firearm_discharge_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_FIREARM_POINT_RATE = (sum(use_of_force_firearm_point_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_BATON_RATE = (sum(use_of_force_baton_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CHEM_SPRAY_RATE = (sum(use_of_force_chem_spray_count) / USE_FORCE_COUNT) * 100, USE_FORCE_IMPACT_DISCHARGE_RATE = (sum(use_of_force_impact_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CANINE_BITE_RATE = (sum(use_of_force_canine_bite_count) / USE_FORCE_COUNT) * 100, USE_FORCE_ELECT_DEVICE_RATE = (sum(use_of_force_elect_device_count) / USE_FORCE_COUNT) * 100)
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% mutate(use_of_force_other_contact_count = use_of_force_count == 1 & ADS_OTHER_CONTACT == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), USE_FORCE_FIREARM_DISCHARGE_RATE = (sum(use_of_force_firearm_discharge_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_FIREARM_POINT_RATE = (sum(use_of_force_firearm_point_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_BATON_RATE = (sum(use_of_force_baton_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CHEM_SPRAY_RATE = (sum(use_of_force_chem_spray_count) / USE_FORCE_COUNT) * 100, USE_FORCE_IMPACT_DISCHARGE_RATE = (sum(use_of_force_impact_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CANINE_BITE_RATE = (sum(use_of_force_canine_bite_count) / USE_FORCE_COUNT) * 100, USE_FORCE_ELECT_DEVICE_RATE = (sum(use_of_force_elect_device_count) / USE_FORCE_COUNT) * 100, USE_FORCE_OTHER_CONTACT_RATE = (sum(use_of_force_other_contact_count) / USE_FORCE_COUNT) * 100)
View(RIPA_force)
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% mutate(use_of_force_other_contact_count = use_of_force_count == 1 & ADS_OTHER_CONTACT == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), STOP_COUNT = sum(count), FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100, USE_FORCE_FIREARM_DISCHARGE_RATE = (sum(use_of_force_firearm_discharge_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_FIREARM_POINT_RATE = (sum(use_of_force_firearm_point_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_BATON_RATE = (sum(use_of_force_baton_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CHEM_SPRAY_RATE = (sum(use_of_force_chem_spray_count) / USE_FORCE_COUNT) * 100, USE_FORCE_IMPACT_DISCHARGE_RATE = (sum(use_of_force_impact_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CANINE_BITE_RATE = (sum(use_of_force_canine_bite_count) / USE_FORCE_COUNT) * 100, USE_FORCE_ELECT_DEVICE_RATE = (sum(use_of_force_elect_device_count) / USE_FORCE_COUNT) * 100, USE_FORCE_OTHER_CONTACT_RATE = (sum(use_of_force_other_contact_count) / USE_FORCE_COUNT) * 100) %>% select(-c(USE_FORCE_COUNT))
View(RIPA_force)
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% mutate(use_of_force_other_contact_count = use_of_force_count == 1 & ADS_OTHER_CONTACT == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), STOP_COUNT = sum(count), FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100, USE_FORCE_FIREARM_DISCHARGE_RATE = (sum(use_of_force_firearm_discharge_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_FIREARM_POINT_RATE = (sum(use_of_force_firearm_point_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_BATON_RATE = (sum(use_of_force_baton_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CHEM_SPRAY_RATE = (sum(use_of_force_chem_spray_count) / USE_FORCE_COUNT) * 100, USE_FORCE_IMPACT_DISCHARGE_RATE = (sum(use_of_force_impact_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CANINE_BITE_RATE = (sum(use_of_force_canine_bite_count) / USE_FORCE_COUNT) * 100, USE_FORCE_ELECT_DEVICE_RATE = (sum(use_of_force_elect_device_count) / USE_FORCE_COUNT) * 100, USE_FORCE_OTHER_CONTACT_RATE = (sum(use_of_force_other_contact_count) / USE_FORCE_COUNT) * 100) %>% select(-c(USE_FORCE_COUNT, STOP_COUNT))
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% mutate(use_of_force_other_contact_count = use_of_force_count == 1 & ADS_OTHER_CONTACT == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), STOP_COUNT = sum(count), FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100, USE_FORCE_FIREARM_POINT_RATE = (sum(use_of_force_firearm_point_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_FIREARM_DISCHARGE_RATE = (sum(use_of_force_firearm_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_BATON_RATE = (sum(use_of_force_baton_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CHEM_SPRAY_RATE = (sum(use_of_force_chem_spray_count) / USE_FORCE_COUNT) * 100, USE_FORCE_IMPACT_DISCHARGE_RATE = (sum(use_of_force_impact_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CANINE_BITE_RATE = (sum(use_of_force_canine_bite_count) / USE_FORCE_COUNT) * 100, USE_FORCE_ELECT_DEVICE_RATE = (sum(use_of_force_elect_device_count) / USE_FORCE_COUNT) * 100, USE_FORCE_OTHER_CONTACT_RATE = (sum(use_of_force_other_contact_count) / USE_FORCE_COUNT) * 100) %>% select(-c(USE_FORCE_COUNT, STOP_COUNT))
RIPA_force <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(use_of_force_firearm_discharge_count = use_of_force_count == 1 & ADS_FIREARM_DISCHARGE == 1) %>% mutate(use_of_force_firearm_point_count = use_of_force_count == 1 & ADS_FIREARM_POINT == 1) %>% mutate(use_of_force_baton_count = use_of_force_count == 1 & ADS_BATON == 1) %>% mutate(use_of_force_chem_spray_count = use_of_force_count == 1 & ADS_CHEM_SPRAY == 1) %>% mutate(use_of_force_impact_discharge_count = use_of_force_count == 1 & ADS_IMPACT_DISCHARGE == 1) %>% mutate(use_of_force_canine_bite_count = use_of_force_count == 1 & ADS_CANINE_BITE == 1)  %>% mutate(use_of_force_elect_device_count = use_of_force_count == 1 & ADS_ELECT_DEVICE == 1) %>% mutate(use_of_force_other_contact_count = use_of_force_count == 1 & ADS_OTHER_CONTACT == 1) %>% summarize(USE_FORCE_COUNT = sum(use_of_force_count), STOP_COUNT = sum(count), FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100, USE_FORCE_FIREARM_POINT_FREQ = (sum(use_of_force_firearm_point_count) / USE_FORCE_COUNT) * 100 , USE_FORCE_FIREARM_DISCHARGE_FREQ = (sum(use_of_force_firearm_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_BATON_FREQ = (sum(use_of_force_baton_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CHEM_SPRAY_FREQ = (sum(use_of_force_chem_spray_count) / USE_FORCE_COUNT) * 100, USE_FORCE_IMPACT_DISCHARGE_FREQ = (sum(use_of_force_impact_discharge_count) / USE_FORCE_COUNT) * 100, USE_FORCE_CANINE_BITE_FREQ = (sum(use_of_force_canine_bite_count) / USE_FORCE_COUNT) * 100, USE_FORCE_ELECT_DEVICE_FREQ = (sum(use_of_force_elect_device_count) / USE_FORCE_COUNT) * 100, USE_FORCE_OTHER_CONTACT_FREQ = (sum(use_of_force_other_contact_count) / USE_FORCE_COUNT) * 100) %>% select(-c(USE_FORCE_COUNT, STOP_COUNT))
write_csv(RIPA_force, path="./RIPA_force.csv")
knitr::opts_chunk$set(echo = TRUE)
# Libraries
library(tidyverse)
options(scipen=999)
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = contraband_count == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(consent_search_no_weapon_count = contraband_no_weapon_count == 1 & count_search_consent == 1) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_NO_WEAPON_COUNT = sum(contraband_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_COUNT = sum(consent_search_no_weapon_count)
)
View(RIPA_counts)
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = contraband_count == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(consent_search_no_weapon_count = contraband_no_weapon_count == 1 & count_search_consent == 1) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_NO_WEAPON_COUNT = sum(contraband_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_COUNT = sum(consent_search_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_RATE = (CONSENT_SEARCH_NO_WEAPON_COUNT / SEARCH_CONSENT_COUNT) * 100
)
View(RIPA_counts)
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_traffic = ifelse(REASON_FOR_STOP == 1, 1, 0)) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(count_search_traffic = ifelse(count_search == 1 & count_traffic == 1, 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(search_no_weapon_count = count_search == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(contraband_traffic_count = ifelse(contraband_count == 1 & count_traffic == 1, 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
STOP_COUNT_TRAFFIC = sum(count_traffic),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
SEARCH_TRAFFIC_COUNT = sum(count_search_traffic),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_TRAFFIC_COUNT = sum(contraband_traffic_count),
SEARCH_NO_WEAPON_COUNT = sum(search_no_weapon_count),
ARREST_COUNT = sum(arrest_count),
USE_FORCE_COUNT = sum(use_of_force_count)
) %>% mutate(SEARCH_COUNT = replace_na(SEARCH_COUNT, 0)) %>% mutate(SEARCH_CONSENT_COUNT = replace_na(SEARCH_CONSENT_COUNT, 0)) %>% mutate(SEARCH_TRAFFIC_COUNT = replace_na(SEARCH_TRAFFIC_COUNT, 0)) %>% mutate(CONTRABAND_COUNT = replace_na(CONTRABAND_COUNT, 0)) %>% mutate(CONTRABAND_TRAFFIC_COUNT = replace_na(CONTRABAND_TRAFFIC_COUNT, 0)) %>% mutate(USE_FORCE_COUNT = replace_na(USE_FORCE_COUNT, 0))
RIPA_stops_pop <- left_join(RIPA_counts, Populationtotals, by=c("AGENCY_NAME" = "Agency")) %>% mutate(STOP_RATE_PER_1000 = (STOP_COUNT / Total) * 1000) %>% mutate(STOP_RATE_TRAFFIC_PER_1000 = (STOP_COUNT_TRAFFIC / Total) * 1000) %>% mutate(SEARCH_RATE_PER_100_STOPS = (SEARCH_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_CONSENT_PER_100_STOPS = (SEARCH_CONSENT_COUNT / STOP_COUNT) * 100) %>% mutate(SEARCH_RATE_PER_100_TRAFFIC_STOPS = (SEARCH_TRAFFIC_COUNT / STOP_COUNT_TRAFFIC) * 100) %>%
mutate(CONTRABAND_RATE_PER_100_SEARCHES = ifelse(SEARCH_COUNT == 0, 0, (CONTRABAND_COUNT / SEARCH_COUNT) * 100)) %>%
mutate(CONTRABAND_RATE_PER_100_TRAFFIC_SEARCHES = if_else(SEARCH_TRAFFIC_COUNT == 0, 0, (CONTRABAND_TRAFFIC_COUNT / SEARCH_TRAFFIC_COUNT) * 100)) %>% mutate(SEARCH_NO_WEAPON_PERCENT = (SEARCH_NO_WEAPON_COUNT / SEARCH_COUNT) * 100) %>%
mutate(ARREST_RATE_PER_100_STOPS = (ARREST_COUNT / STOP_COUNT) * 100) %>%
mutate(FORCE_RATE_PER_100_STOPS = (USE_FORCE_COUNT / STOP_COUNT) * 100) %>% select(-c(Hispanic, White, Black, `Native American`, Asian, `Pacific Islander`, Multiracial, Total, STOP_COUNT, contains("COUNT")))
write_csv(RIPA_stops_pop, path="./RIPA_general_stops.csv")
View(RIPA_stops_pop)
write_csv(RIPA_stops_pop, path="./RIPA_general_stops.csv")
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = count_search == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(consent_search_no_weapon_count = contraband_no_weapon_count == 1 & count_search_consent == 1) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_NO_WEAPON_COUNT = sum(contraband_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_COUNT = sum(consent_search_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_RATE = (CONSENT_SEARCH_NO_WEAPON_COUNT / SEARCH_CONSENT_COUNT) * 100
)
View(RIPA_counts)
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = count_search == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(consent_search_no_weapon_count = contraband_no_weapon_count == 1 & count_search_consent == 1) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_NO_WEAPON_COUNT = sum(contraband_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_COUNT = sum(consent_search_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_RATE = (CONSENT_SEARCH_NO_WEAPON_COUNT / SEARCH_CONSENT_COUNT) * 100
) %>% select(-c(contains("COUNT")))
RIPA_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = count_search == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(consent_search_no_weapon_count = contraband_no_weapon_count == 1 & count_search_consent == 1) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_NO_WEAPON_COUNT = sum(contraband_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_COUNT = sum(consent_search_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_RATE = (CONSENT_SEARCH_NO_WEAPON_COUNT / SEARCH_CONSENT_COUNT) * 100
) %>% select(-c(SEARCH_COUNT, STOP_COUNT))
write_csv(RIPA_counts, path="./RIPA_consent.csv")
RIPA_consent_no_weapon <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(contraband_count = ifelse(CED_NONE_CONTRABAND == 0 & count_search == 1, 1, 0)) %>% mutate(contraband_no_weapon_count = count_search == 1 & CED_FIREARM == 0 & CED_AMMUNITION == 0 & CED_WEAPON == 0) %>% mutate(consent_search_no_weapon_count = contraband_no_weapon_count == 1 & count_search_consent == 1) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_COUNT = sum(count_search),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
CONTRABAND_COUNT = sum(contraband_count),
CONTRABAND_NO_WEAPON_COUNT = sum(contraband_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_COUNT = sum(consent_search_no_weapon_count),
CONSENT_SEARCH_NO_WEAPON_RATE = (CONSENT_SEARCH_NO_WEAPON_COUNT / SEARCH_CONSENT_COUNT) * 100
) %>% select(-c(SEARCH_COUNT, STOP_COUNT))
write_csv(RIPA_consent_no_weapon, path="./RIPA_consent.csv")
RIPA_ban_pretext_impact <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0)) %>% mutate(arrest_count_ban_pretext = ifelse(arrest_count == 1 & count_search_consent == 0, 1, 0)) %>% mutate(force_count_ban_pretext = ifelse(use_of_force_count == 1 & count_search_consent == 0, 1, 0)) %>% mutate(firearm_discharge_count_ban_pretext = ifelse(firearm_discharge_count == 1 & count_search_consent == 0, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
ARREST_COUNT = sum(arrest_count),
ARREST_COUNT_BAN_PRETEXT = sum(arrest_count_ban_pretext),
PERCENT_REDUCTION_ARREST_BAN = ((ARREST_COUNT_BAN_PRETEXT - ARREST_COUNT) / ARREST_COUNT) * 100,
USE_FORCE_COUNT = sum(use_of_force_count),
USE_FORCE_COUNT_BAN_PRETEXT = sum(force_count_ban_pretext),
PERCENT_REDUCTION_FORCE_BAN = ((USE_FORCE_COUNT_BAN_PRETEXT - USE_FORCE_COUNT) / USE_FORCE_COUNT) * 100,
FIREARM_DISCHARGE_COUNT = sum(firearm_discharge_count),
FIREARM_DISCHARGE_COUNT_BAN_PRETEXT = sum(firearm_discharge_count_ban_pretext),
PERCENT_REDUCTION_FIREARM_DISCHARGE_BAN = ((FIREARM_DISCHARGE_COUNT_BAN_PRETEXT - FIREARM_DISCHARGE_COUNT) / FIREARM_DISCHARGE_COUNT) * 100
)
View(RIPA_ban_pretext_impact)
RIPA_ban_pretext_impact <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0)) %>% mutate(arrest_count_ban_pretext = ifelse(arrest_count == 1 & count_search_consent == 0, 1, 0)) %>% mutate(force_count_ban_pretext = ifelse(use_of_force_count == 1 & count_search_consent == 0, 1, 0)) %>% mutate(firearm_discharge_count_ban_pretext = ifelse(firearm_discharge_count == 1 & count_search_consent == 0, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
ARREST_COUNT = sum(arrest_count),
ARREST_COUNT_BAN_PRETEXT = sum(arrest_count_ban_pretext),
PERCENT_DIFF_ARREST_BAN = ((ARREST_COUNT_BAN_PRETEXT - ARREST_COUNT) / ARREST_COUNT) * 100,
USE_FORCE_COUNT = sum(use_of_force_count),
USE_FORCE_COUNT_BAN_PRETEXT = sum(force_count_ban_pretext),
PERCENT_DIFF_FORCE_BAN = ((USE_FORCE_COUNT_BAN_PRETEXT - USE_FORCE_COUNT) / USE_FORCE_COUNT) * 100,
FIREARM_DISCHARGE_COUNT = sum(firearm_discharge_count),
FIREARM_DISCHARGE_COUNT_BAN_PRETEXT = sum(firearm_discharge_count_ban_pretext),
PERCENT_DIFF_FIREARM_DISCHARGE_BAN = ((FIREARM_DISCHARGE_COUNT_BAN_PRETEXT - FIREARM_DISCHARGE_COUNT) / FIREARM_DISCHARGE_COUNT) * 100
)
RIPA_ban_pretext_impact <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0)) %>% mutate(arrest_count_ban_pretext = ifelse(arrest_count == 1 & count_search_consent == 0, 1, 0)) %>% mutate(force_count_ban_pretext = ifelse(use_of_force_count == 1 & count_search_consent == 0, 1, 0)) %>% mutate(firearm_discharge_count_ban_pretext = ifelse(firearm_discharge_count == 1 & count_search_consent == 0, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
ARREST_COUNT = sum(arrest_count),
ARREST_COUNT_BAN_PRETEXT = sum(arrest_count_ban_pretext),
PERCENT_DIFF_ARREST_BAN = ((ARREST_COUNT_BAN_PRETEXT - ARREST_COUNT) / ARREST_COUNT) * 100,
USE_FORCE_COUNT = sum(use_of_force_count),
USE_FORCE_COUNT_BAN_PRETEXT = sum(force_count_ban_pretext),
PERCENT_DIFF_FORCE_BAN = ((USE_FORCE_COUNT_BAN_PRETEXT - USE_FORCE_COUNT) / USE_FORCE_COUNT) * 100,
FIREARM_DISCHARGE_COUNT = sum(firearm_discharge_count),
FIREARM_DISCHARGE_COUNT_BAN_PRETEXT = sum(firearm_discharge_count_ban_pretext),
PERCENT_DIFF_FIREARM_DISCHARGE_BAN = ((FIREARM_DISCHARGE_COUNT_BAN_PRETEXT - FIREARM_DISCHARGE_COUNT) / FIREARM_DISCHARGE_COUNT) * 100
) %>% select(-c(contains("COUNT")))
RIPA_ban_pretext_impact <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>% mutate(count_search = ifelse(ADS_SEARCH_PERSON == 1 |  ADS_SEARCH_PROPERTY == 1, 1, 0)) %>% mutate(count_search_consent = ifelse(count_search == 1 & (BFS_CONSENT_GIVEN == 1 & BFS_OFFICER_SAFETY == 0 & BFS_SEARCH_WARRANT == 0 & BFS_PAROLE == 0 & BFS_SUSPECT_WEAPON == 0 & BFS_VISIBLE_CONTRABAND == 0 & BFS_ODOR_CONTRABAND == 0 & BFS_CANINE_DETECT == 0 & BFS_EVIDENCE == 0 & BFS_INCIDENT == 0 & BFS_EXIGENT_CIRCUM == 0 & BFS_VEHICLE_INVENT == 0 & BFS_SCHOOL_POLICY == 0), 1, 0)) %>% mutate(arrest_count = ifelse(ROS_CUSTODIAL_WITHOUT_WARRANT == 1, 1, 0)) %>% mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0)) %>% mutate(arrest_count_ban_pretext = ifelse(arrest_count == 1 & count_search_consent == 0, 1, 0)) %>% mutate(force_count_ban_pretext = ifelse(use_of_force_count == 1 & count_search_consent == 0, 1, 0)) %>% mutate(firearm_discharge_count_ban_pretext = ifelse(firearm_discharge_count == 1 & count_search_consent == 0, 1, 0)) %>% summarize(
STOP_COUNT = sum(count),
SEARCH_CONSENT_COUNT = sum(count_search_consent),
ARREST_COUNT = sum(arrest_count),
ARREST_COUNT_BAN_PRETEXT = sum(arrest_count_ban_pretext),
PERCENT_DIFF_ARREST_BAN = ((ARREST_COUNT_BAN_PRETEXT - ARREST_COUNT) / ARREST_COUNT) * 100,
USE_FORCE_COUNT = sum(use_of_force_count),
USE_FORCE_COUNT_BAN_PRETEXT = sum(force_count_ban_pretext),
PERCENT_DIFF_FORCE_BAN = ((USE_FORCE_COUNT_BAN_PRETEXT - USE_FORCE_COUNT) / USE_FORCE_COUNT) * 100,
FIREARM_DISCHARGE_COUNT = sum(firearm_discharge_count),
FIREARM_DISCHARGE_COUNT_BAN_PRETEXT = sum(firearm_discharge_count_ban_pretext),
PERCENT_DIFF_FIREARM_DISCHARGE_BAN = ((FIREARM_DISCHARGE_COUNT_BAN_PRETEXT - FIREARM_DISCHARGE_COUNT) / FIREARM_DISCHARGE_COUNT) * 100
) %>% select(-c(contains("COUNT")))
write_csv(RIPA_ban_pretext_impact, path="./RIPA_ban_pretext_impact.csv")
CDS_Codes <- read.csv("~/Google Drive/SENIOR YEAR!/Winter Quarter/CS191/CDS_Codes.csv")
View(CDS_Codes)
View(CDS_Codes)
RIPA_force_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>%mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0))
left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code"))
RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']<-factor(RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS'])
RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']<-as.factor(as.character(RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']))
left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code"))
CDS_Codes <- read.csv("~/Google Drive/SENIOR YEAR!/Winter Quarter/CS191/CDS_Codes.csv")
View(CDS_Codes)
RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']<-as.numeric(as.character(RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']))
left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code"))
left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code")) %>% mutate(force_count_low_offense = ifelse(use_of_force_count == 1 & Offense.Level != "F"))
left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code")) %>% mutate(force_count_low_offense = ifelse(use_of_force_count == 1 & Offense.Level != "F", 1, 0))
RIPA_force_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>%mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0))
RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']<-as.numeric(as.character(RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']))
left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code")) %>% mutate(force_count_low_offense = ifelse(use_of_force_count == 1 & Offense.Level != "F", 1, 0)) %>% (mutate(firearm_discharge_count_low_offense = ifelse(firearm_discharge_count == 1 & Offense.Level != "F", 1, 0))) %>% summarize(
STOP_COUNT = sum(count),
FORCE_COUNT = sum(use_of_force_count),
FORCE_COUNT_LOW_OFFENSE = sum(force_count_low_offense),
PERCENT_FORCE_LOW_OFFENSE = (FORCE_COUNT_LOW_OFFENSE / FORCE_COUNT) * 100,
FIREARM_DISCHARGE_COUNT = sum(firearm_discharge_count),
FIREARM_DISCHARGE_COUNT_LOW_OFFENSE = sum(firearm_discharge_count_low_offense),
PERCENT_FIREARM_DISCHARGE_LOW_OFFENSE = (FIREARM_DISCHARGE_COUNT_LOW_OFFENSE / FIREARM_DISCHARGE_COUNT) * 100
)
RIPA_force_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>%mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0))
RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']<-as.numeric(as.character(RIPA_force_counts[,'ROS_CUSTODIAL_WOUT_WARRANT_CDS']))
View(RIPA_force_counts)
RIPA_force_counts %>% distinct(firearm_discharge_count)
RIPA_force_counts %>% count(firearm_discharge_count)
left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code")) %>% mutate(force_count_low_offense = ifelse(use_of_force_count == 1 & Offense.Level != "F", 1, 0)) %>% (mutate(firearm_discharge_count_low_offense = ifelse(firearm_discharge_count == 1 & Offense.Level != "F", 1, 0)))
RIPA_join_cds <- left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code"))
View(RIPA_join_cds)
RIPA_force_counts %>% count(ROS_CUSTODIAL_WOUT_WARRANT_CDS)
RIPA.Stop.Data.2018 %>% count(ROS_CUSTODIAL_WOUT_WARRANT_CDS)
RIPA_annotated <- RIPA_annotated[!(RIPA_annotated$ROS_CUSTODIAL_WOUT_WARRANT_CDS == " ") , ] %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = strsplit(as.character(ROS_CUSTODIAL_WOUT_WARRANT_CDS), ", ")) %>% unnest(ROS_CUSTODIAL_WOUT_WARRANT_CDS) %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = as.numeric(ROS_CUSTODIAL_WOUT_WARRANT_CDS))
RIPA_force_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>%mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0))
RIPA_join_cds <- left_join(RIPA_force_counts, CDS_Codes, by=c("ROS_CUSTODIAL_WOUT_WARRANT_CDS"="CDS.Code"))
RIPA.Stop.Data.2018 %>% count(ROS_CUSTODIAL_WOUT_WARRANT_CDS)
RIPA.Stop.Data.2018 %>% count(ROS_CUSTODIAL_WOUT_WARRANT_CDS)
RIPA_annotated <- RIPA.Stop.Data.2018 %>% select (-c(G_FEMALE, G_GENDER_NONCONFORMING, G_MALE, G_TRANSGENDER_MAN, G_TRANSGENDER_WOMAN, G_FULL, G_MULTIGENDER)) %>% select(1:14, GENDER, everything()) %>% mutate(ADS_SEARCH_PERSON = replace_na(ADS_SEARCH_PERSON, 0)) %>% mutate(ADS_SEARCH_PROPERTY = replace_na(ADS_SEARCH_PROPERTY, 0)) %>% mutate(BFS_CONSENT_GIVEN = replace_na(BFS_CONSENT_GIVEN, 0)) %>% mutate(BFS_OFFICER_SAFETY = replace_na(BFS_OFFICER_SAFETY, 0)) %>% mutate(BFS_SEARCH_WARRANT = replace_na(BFS_SEARCH_WARRANT, 0)) %>% mutate(BFS_PAROLE = replace_na(BFS_PAROLE, 0)) %>% mutate(BFS_SUSPECT_WEAPON = replace_na(BFS_SUSPECT_WEAPON, 0)) %>% mutate(BFS_VISIBLE_CONTRABAND = replace_na(BFS_VISIBLE_CONTRABAND, 0)) %>% mutate(BFS_ODOR_CONTRABAND = replace_na(BFS_ODOR_CONTRABAND, 0)) %>% mutate(BFS_CANINE_DETECT = replace_na(BFS_CANINE_DETECT, 0)) %>% mutate(BFS_EVIDENCE = replace_na(BFS_EVIDENCE, 0)) %>% mutate(BFS_INCIDENT = replace_na(BFS_INCIDENT, 0)) %>% mutate(BFS_EXIGENT_CIRCUM = replace_na(BFS_EXIGENT_CIRCUM, 0)) %>% mutate(BFS_VEHICLE_INVENT = replace_na(BFS_VEHICLE_INVENT, 0)) %>% mutate(BFS_SCHOOL_POLICY = replace_na(BFS_SCHOOL_POLICY, 0))
RIPA_annotated <- RIPA_annotated[!(RIPA_annotated$ROS_CUSTODIAL_WOUT_WARRANT_CDS == " ") , ] %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = strsplit(as.character(ROS_CUSTODIAL_WOUT_WARRANT_CDS), ", ")) %>% unnest(ROS_CUSTODIAL_WOUT_WARRANT_CDS) %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = as.numeric(ROS_CUSTODIAL_WOUT_WARRANT_CDS))
RIPA_force_counts <- RIPA_annotated %>% group_by(AGENCY_NAME) %>% mutate(count = 1) %>%mutate(use_of_force_count = ifelse(ADS_FIREARM_POINT == 1 | ADS_FIREARM_DISCHARGE == 1 | ADS_BATON == 1 | ADS_CHEM_SPRAY == 1 | ADS_IMPACT_DISCHARGE == 1 | ADS_CANINE_BITE == 1 | ADS_ELECT_DEVICE == 1 | ADS_OTHER_CONTACT == 1, 1, 0)) %>% mutate(firearm_discharge_count = ifelse(ADS_FIREARM_DISCHARGE == 1, 1, 0))
RIPA.Stop.Data.2018 %>% count(ROS_CUSTODIAL_WOUT_WARRANT_CDS
RIPA_force_counts %>% count(ROS_CUSTODIAL_WOUT_WARRANT_CDS)
RIPA_force_counts %>% count(ROS_CUSTODIAL_WOUT_WARRANT_CDS)
RIPA_annotated <- RIPA_annotated %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = strsplit(as.character(ROS_CUSTODIAL_WOUT_WARRANT_CDS), ", ")) %>% unnest(ROS_CUSTODIAL_WOUT_WARRANT_CDS) %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = as.numeric(ROS_CUSTODIAL_WOUT_WARRANT_CDS)) %>% mutate(ROS_IN_FIELD_CITE_RELEASE_CDS = strsplit(as.character(ROS_IN_FIELD_CITE_RELEASE_CDS), ", ")) %>% unnest(ROS_IN_FIELD_CITE_RELEASE_CDS) %>% mutate(ROS_IN_FIELD_CITE_RELEASE_CDS = as.numeric(ROS_IN_FIELD_CITE_RELEASE_CDS)) %>% mutate(ROS_CITATION_CDS = strsplit(as.character(ROS_CITATION_CDS), ", ")) %>% unnest(ROS_CITATION_CDS) %>% mutate(ROS_CITATION_CDS = as.numeric(ROS_CITATION_CDS)) %>% mutate(ROS_WARNING_CDS = strsplit(as.character(ROS_WARNING_CDS), ", ")) %>% unnest(ROS_WARNING_CDS) %>% mutate(ROS_WARNING_CDS = as.numeric(ROS_WARNING_CDS))
RIPA_annotated <- RIPA_annotated %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = strsplit(as.character(ROS_CUSTODIAL_WOUT_WARRANT_CDS), ", ")) %>% unnest(ROS_CUSTODIAL_WOUT_WARRANT_CDS) %>% mutate(ROS_CUSTODIAL_WOUT_WARRANT_CDS = as.numeric(ROS_CUSTODIAL_WOUT_WARRANT_CDS)) %>% mutate(ROS_IN_FIELD_CITE_RELEASE_CDS = strsplit(as.character(ROS_IN_FIELD_CITE_RELEASE_CDS), ", ")) %>% unnest(ROS_IN_FIELD_CITE_RELEASE_CDS) %>% mutate(ROS_IN_FIELD_CITE_RELEASE_CDS = as.numeric(ROS_IN_FIELD_CITE_RELEASE_CDS)) %>% mutate(ROS_CITATION_CDS = strsplit(as.character(ROS_CITATION_CDS), ", ")) %>% unnest(ROS_CITATION_CDS) %>% mutate(ROS_CITATION_CDS = as.numeric(ROS_CITATION_CDS)) %>% mutate(ROS_WARNING_CDS = strsplit(as.character(ROS_WARNING_CDS), ", ")) %>% unnest(ROS_WARNING_CDS) %>% mutate(ROS_WARNING_CDS = as.numeric(ROS_WARNING_CDS))
